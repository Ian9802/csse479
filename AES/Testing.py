
sBox = [
    [ 99,124,119,123,242,107,111,197, 48,  1,103, 43,254,215,171,118],
    [202,130,201,125,250, 89, 71,240,173,212,162,175,156,164,114,192],
    [183,253,147, 38, 54, 63,247,204, 52,165,229,241,113,216, 49, 21],
    [  4,199, 35,195, 24,150,  5,154,  7, 18,128,226,235, 39,178,117],
    [  9,131, 44, 26, 27,110, 90,160, 82, 59,214,179, 41,227, 47,132],
    [ 83,209,  0,237, 32,252,177, 91,106,203,190, 57, 74, 76, 88,207],
    [208,239,170,251, 67, 77, 51,133, 69,249,  2,127, 80, 60,159,168],
    [ 81,163, 64,143,146,157, 56,245,188,182,218, 33, 16,255,243,210],
    [205, 12, 19,236, 95,151, 68, 23,196,167,126, 61,100, 93, 25,115],
    [ 96,129, 79,220, 34, 42,144,136, 70,238,184, 20,222, 94, 11,219],
    [224, 50, 58, 10, 73,  6, 36, 92,194,211,172, 98,145,149,228,121],
    [231,200, 55,109,141,213, 78,169,108, 86,244,234,101,122,174,  8],
    [186,120, 37, 46, 28,166,180,198,232,221,116, 31, 75,189,139,138],
    [112, 62,181,102, 72,  3,246, 14, 97, 53, 87,185,134,193, 29,158],
    [225,248,152, 17,105,217,142,148,155, 30,135,233,206, 85, 40,223],
    [140,161,137, 13,191,230, 66,104, 65,153, 45, 15,176, 84,187, 22]
]

def start(binString):
    aBox = [[] for foo in range(0, 4)]
    for x in range(0, 4):
        for y in range(0, 4):
            aBox[y % 4].append(binString[(32*x)+(8*y):(32*x)+(8*y)+8])
    return aBox

aBox = start("00000000000000010000001000000011000001000000010100000110000001110000100000001001000010100000101100001100000011010000111000001111")
aBox2 = [['00000000', '00000100', '00001000', '00001100'],
         ['00000001', '00000101', '00001001', '00001101'],
         ['00000010', '00000110', '00001010', '00001110'],
         ['00000011', '00000111', '00001011', '00001111']]

#print(start("11110101000000000101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101"))

print(aBox == aBox2)

def bs(aBox):
    bBox = [[] for foo in range(0, 4)]
    for x in range(0, 4):
        for y in range(0, 4):
            bBox[x].append(indBS(aBox[x][y]))
    return bBox

def indBS(b):
    row = b[:4]
    col = b[4:]
    return sBox[int(row, 2)][int(col, 2)]

print(indBS('10001011')== 61)

bBox = bs(aBox)
bBox2 = [[99, 242, 48, 254],
         [124, 107, 1, 215],
         [119, 111, 103, 171],
         [123, 197, 43, 118]]
print(bBox == bBox2)

def sr(bBox):
    cBox = [[] for foo in range(0, 4)]
    for x in range(0, 4):
        for y in range(0, 4):
            cBox[x].append(bBox[x][(y+x) % 4])
    return cBox

cBox = sr(bBox)
cBox2 = [[99, 242, 48, 254],
         [107, 1, 215, 124],
         [103, 171, 119, 111],
         [118, 123, 197, 43]]
print(cBox == cBox2)

cdKey = [
    [2, 3, 1, 1],
    [1, 2, 3, 1],
    [1, 1, 2, 3],
    [3, 1, 1, 2]
]

def mc(cBox):
    dBox = [[] for foo in range(0, 4)]
    for x in range(0, 4):
        dBox[x].extend(mux(cBox[x]))
    return dBox


def mux(col):
    column = list()
    for x in range(0, 4):
        value = 0
        for y in range(0, 4):
            #might be how this works?
            value = value ^ ((cdKey[x][y]*col[y])%255)
        column.append(value)
    return column


val = [['11110101', '01010101', '01010101', '01010101'],
       ['00000000', '01010101', '01010101', '01010101'],
       ['01010101', '01010101', '01010101', '01010101'],
       ['01010101', '01010101', '01010101', '01010101']]

def convert(value):
    out = [[] for foo in range(0, 4)]
    for x in range(0, 4):
        for y in range(0, 4):
            out[x].append(int(val[x][y], 2))
    return out

#print(convert(val))
print(mc([[245, 85, 85, 85], [0, 85, 85, 85], [85, 85, 85, 85], [85, 85, 85, 85]]))

dBox = mc(cBox)
dBox2 = [[198, 726, 48, 254],
         [107, 2, 645, 124],
         [103, 171, 238, 333],
         [354, 123, 197, 86]]
print(dBox == dBox2)

key = [['00000000', '00000100', '00001000', '00001100'],
['00000001', '00000101', '00001001', '00001101'],
['00000010', '00000110', '00001010', '00001110'],
['00000011', '00000111', '00001011', '00001111']]
